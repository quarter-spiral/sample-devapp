<markdown class="documentation">

Use the Flash SDK to quickly and easily integrate your Flash game with the various Quarter Spiral APIs.

### Setup

Import these packages:

```actionscript
import flash.display.LoaderInfo;
import flash.external.ExternalInterface;
import flash.system.Security;
```

Then make sure to allow communication with QS:

```actionscript
var flashVars:Object = LoaderInfo(this.root.loaderInfo).parameters;

flash.system.Security.allowInsecureDomain(flashVars.qsCanvasHost)
flash.system.Security.allowDomain(flashVars.qsCanvasHost)
```

Once the QS initialization is done, the SDK will reach out to a special callback. Register it like this:

```actionscript
function qsSetupCallback(qs):void {
  // QS SDK ready!
}
ExternalInterface.addCallback('qsSetupCallback', qsSetupCallback);
```

Now you got to initialize the QS SDK with:

```actionscript
ExternalInterface.call('QS.setup')
```

**Make sure to call ``QS.setup`` only once!**

Once that callback was called you have access to the full QS functionality.

### Retrieve information about the player

First register the callback to retrieve the info about the player or errors in case they happen:

```actionscript
function qsPlayerInfoCallback(player):void {
  trace("Player info loaded");
  trace(player.name);
  trace(player.email);
}
ExternalInterface.addCallback('qsPlayerInfoCallback', qsPlayerInfoCallback);

function qsPlayerInfoErrorCallback(message):void {
  //An error has happened!
}
ExternalInterface.addCallback('qsPlayerInfoErrorCallback', qsPlayerInfoErrorCallback);
```

Then call ``QS.flash.retrievePlayerInfo`` to trigger the retrieval of the information:

```actionscript
function qsSetupCallback(qs):void {
  ExternalInterface.call('QS.flash.retrievePlayerInfo')
}
ExternalInterface.addCallback('qsSetupCallback', qsSetupCallback);

ExternalInterface.call('QS.setup')
```

The ``retrievePlayerInfo`` call gives you a player object that holds information about the currently logged in player. You can access it's ``name``, ``email`` and ``uuid`` which is it's unique identifier within the Quarter Spiral universe.

In some cases an email address might not be present. For the time being we return ``unknown@example.com`` in these cases but this will be subject to change.

### Manage player data

Quarter Spiral lets you save data for every player that plays your game.

```actionscript
function qsSetupCallback(qs):void {
  ExternalInterface.call('QS.flash.setPlayerData', {
    highScore: 190,
    tutorialCompleted: true
  })
}
ExternalInterface.addCallback('qsSetupCallback', qsSetupCallback);

ExternalInterface.call('QS.setup')
```

This call will overwrite all data that was previously stored for this player. If you only want to adjust a single value you can do that:

```javascript
function qsSetupCallback(qs):void {
  ExternalInterface.call('QS.flash.setPlayerData', 'highScore', 190);
}
ExternalInterface.addCallback('qsSetupCallback', qsSetupCallback);

ExternalInterface.call('QS.setup')
```

To know if the data could be saved or an error have occurred there are two callbacks you can register:

```actionscript
function qsPlayerDataSetCallback(data):void {
  //Data was saved and the complete data is passed in in the data variable.
  //Please note that even if you only set a single value the data variable always holds the complete data!
}
ExternalInterface.addCallback('qsPlayerDataSetCallback', qsPlayerDataSetCallback);

function qsPlayerDataSetErrorCallback(message):void {
  trace("Problem setting player data:: " + message)
}
ExternalInterface.addCallback('qsPlayerDataSetErrorCallback', qsPlayerDataSetErrorCallback);
```

There is also a convenient way to retrieve the current player's data:

```actionscript
function qsPlayerDataCallback(data):void {
  trace("Player data loaded!")
}
ExternalInterface.addCallback('qsPlayerDataCallback', qsPlayerDataCallback);

function qsPlayerDataErrorCallback(message):void {
  trace("Problem loading player data: " + message)
}
ExternalInterface.addCallback('qsPlayerDataErrorCallback', qsPlayerDataErrorCallback);

function qsSetupCallback(qs):void {
  ExternalInterface.call('QS.flash.retrievePlayerData')
}
ExternalInterface.call('QS.setup')
```


</markdown>